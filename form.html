<!DOCTYPE html>
<html>
<style>
th, td {
	padding-right: 30px;
}
</style>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<title>Fiber Laser Phased-Array Controller</title>
		
		<link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">
		
		<script type="text/javascript" src="/assets/jquery.js"></script>
	    <script src="assets/bootstrap/js/bootstrap.min.js"></script>

		
		<script>
		function hide19(){ // Used to hide 19 channel offsets when 7 channel is selected
			$("input[name='offset19']").hide();
			$("label[name='offset19']").hide();
		};
		
		function show19(){ // Used to hide 19 channel offsets when 7 channel is selected
			$("input[name='offset19']").show();
			$("label[name='offset19']").show();
		};
		
		function load_table(){
			var table;
			$.getJSON( "/saved_values/default7.json", function(result){
				$.each(result, function(i, field){
					table += "<tr><td>" + i + "</td><td>" + field + "</td></tr>";
				});
			});
			console.log(table);
			$("#7ChVal").html(table);
		};
		
		$(document).ready(function()
		{
			if("#channel7[checked]"){
				hide19();
			}
			$("#load7").click(function(){
				$.getJSON( "/saved_values/default7.json", function(result){
					$.each(result, function(i, field){
						if(i == "pert"){
							document.getElementById("pertVal").value = field;
						}
						else if(i == "leap"){
							document.getElementById("leapVal").value = field;
						}
						else if(i == "round_trip"){
							document.getElementById("tripVal").value = field;
						}
						document.getElementById(i).value = field;
					});
					console.log( "success" );
				})
				.done(function(){
					console.log( "done" );
				})
				.fail(function(){
					console.log( "error" );
				})
				.always(function(){
					console.log( "complete" );
				});
				document.getElementById("channel7").checked = true;
				load_table();
				hide19();
			});
			
			$("#load19").click(function(){
				$.getJSON( "/saved_values/default19.json", function(result){
					$.each(result, function(i, field){
						document.getElementById(i).value = field;
						if(i == "pert"){
							document.getElementById("pertVal").value = field;
						}
						else if(i == "leap"){
							document.getElementById("leapVal").value = field;
						}
						else if(i == "round_trip"){
							document.getElementById("tripVal").value = field;
						}
					});
					console.log( "success" );
				})
				.done(function(){
					console.log( "done" );
				})
				.fail(function(){
					console.log( "error" );
				})
				.always(function(){
					console.log( "complete" );
				});
				document.getElementById("channel19").checked = true;
				show19();
			});
		});
		</script>
	</head>
    <body>
		<div class="container">	
		<h1>Fiber Laser Phased-Array Controller</h1>
		<p>Welcome to the Fiber Laser Phased-Array Controller</p>
		<form action="/" method="post">
			<fieldset>
				<label>Channels:</label>
				<input type="radio" id="channel7" name="channel" value="7" onclick="hide19()" checked />7
				<input type="radio" id="channel19" name="channel" value="19" onclick="show19()" />19	<br />	<br />
				
				<table>
				<tr><td><label for="pert">Pert gain:</label>
				<input type="range" name="pert" id="pert" min="0.001" value="0.03" max="1" step="0.001" oninput="pertVal.value = pert.value"/>
				(default value: 0.03; range: 0.001 - 1) 
				<input name="pertVal" type="number" min="0.001" value="0.03" max="1" id="pertVal" readonly /></td></tr>
				
				<tr><td><label for="leap">Leap gain:</label>
				<input type="range" id="leap" name="leap" min="1" value="1500" max="10000" step="1" oninput="leapVal.value = leap.value" />
				(default value: 1500; range: 1 - 10000)
				<input name="leapVal" type="number" min="1" value="1500" max="10000" id="leapVal" readonly /></td></tr>

				<tr><td><label for="round_trip">Round trip time:</label>
				<input type="range" id="round_trip" name="round_trip" min="1e-8" value="1e-8" max="1e-7" step="1e-8" oninput="tripVal.value = round_trip.value"/>
				(default value: 10ns)
				<input name="tripVal" type="number" min="1e-8" value="1e-8" max="1e-7" id="tripVal" readonly /></td></tr>
				</table>
				<br />
						
				Channel offsets (default for all: 0): <br />
				<table>
				<tr>
				
				<th><label for="ch1"> 1:</label>
				<input type="number" name="offset7" id="offset1" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label for="ch2"> 2:</label>
				<input type="number" name="offset7" id="offset2" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label for="ch3"> 3:</label>
				<input type="number" name="offset7" id="offset3" value="0" placeholder="Enter offset" />
				</th>
				
				<tr>
				<th>
				<label for="ch4"> 4:</label>
				<input type="number" name="offset7" id="offset4" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label for="ch5"> 5:</label>
				<input type="number" name="offset7" id="offset5" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label for="ch6"> 6:</label>
				<input type="number" name="offset7" id="offset6" value="0" placeholder="Enter offset" />
				</th>
				</tr>
				
				<tr>
				<th>
				<label for="ch7"> 7:</label>
				<input type="number" name="offset7" id="offset7" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch8"> 8:</label>
				<input type="number" name="offset19" id="offset8" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch9"> 9:</label>
				<input type="number" name="offset19" id="offset9" value="0" placeholder="Enter offset" />
				</th>
				</tr>
				
				<tr>
				<th>
				<label name="offset19" for="ch10">10:</label>
				<input type="number" name="offset19" id="offset10" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch11">11:</label>
				<input type="number" name="offset19" id="offset11" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch12">12:</label>
				<input type="number" name="offset19" id="offset12" value="0" placeholder="Enter offset" />
				</th>
				</tr>
				
				<tr>
				<th>
				<label name="offset19" for="ch13">13:</label>
				<input type="number" name="offset19" id="offset13" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch14">14:</label>
				<input type="number" name="offset19" id="offset14" value="0" placeholder="Enter offset" />
				</th>
			
				<th>
				<label name="offset19" for="ch15">15:</label>
				<input type="number" name="offset19" id="offset15" value="0" placeholder="Enter offset" />
				</th>
				</tr>
				
				<tr>
				<th>
				<label name="offset19" for="ch16">16:</label>
				<input type="number" name="offset19" id="offset16" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch17">17:</label>
				<input type="number" name="offset19" id="offset17" value="0" placeholder="Enter offset" />
				</th>
				
				<th>
				<label name="offset19" for="ch18">18:</label>
				<input type="number" name="offset19" id="offset18" value="0" placeholder="Enter offset" />
				</th>
				</tr>
				
				<tr>
				<th>
				<th>
				<label name="offset19" for="ch19">19:</label>
				<input type="number" name="offset19" id="offset19" value="0" placeholder="Enter offset" />
				</th>
				</th>
				</tr>
				
				</table>
								
				<button type="submit" class="btn btn-primary btn-lg" formaction="/run">Run</button>
				<button type="submit" class="btn btn-primary btn-lg" formaction="/update">Update</button>
				<button type="submit" class="btn btn-primary btn-lg" formaction="/reset">Reset</button>
				<button type="submit" onclick="return confirm('Are you sure you wish to overwrite the saved 7-channel presets?')" class="btn btn-primary btn-lg save" id="save7" formaction="/save">Save 7 Channel Value Set</button>
				<button type="submit" onclick="return confirm('Are you sure you wish to overwrite the saved 19-channel presets?')" class="btn btn-primary btn-lg save" id="save19" formaction="/save">Save 19 Channel Value Set</button>
				<button type="button" onclick="" class="btn btn-primary btn-lg load" id="load7" formaction="/load7">Load 7 Channel Presets</button>
				<button type="button" onclick="" class="btn btn-primary btn-lg load" id="load19" formaction="/load19">Load 19 Channel Presets</button>
			</fieldset>
			</form>
		<div id="7ChVal"></div>
		<div id="19ChVal"></div>
		</div>
	</body>
</html>