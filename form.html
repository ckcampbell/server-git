<!DOCTYPE html>
<html>
<style>
th, td {
	padding-right: 30px;
}
</style>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<title>Fiber Laser Phased-Array Controller</title>
		
		<link href="assets/bootstrap/css/bootstrap.min.css" type="text/css" rel="stylesheet">
		<link href="assets/bootstrap/css/custom.css" type="text/css" rel="stylesheet">

		<script type="text/javascript" src="/assets/jquery.js"></script>
	    <script src="assets/bootstrap/js/bootstrap.min.js"></script>

		<style>
		body{
			background-color:#F2EFEB;
		}
		tr.spaceUnder > td
		{
			padding-bottom: 1em;
		}
		</style>
		
		<script>
		$(document).ready(function()
		{
			function load_table(){
				$.getJSON( "/saved_values/default7.json", function(result){
					$.each(result, function(i, field){
						if(i == "pert"){
							$('#pert7table').html(field);
						}
						else if(i == "leap"){
							$('#leap7table').html(field);
						}
						else if(i == "round_trip"){
							$('#trip7table').html(field);
						}
						else if(i == "offset7"){
							for(j = 0; j < 7; j++){
								var channel = j + 1;
								$("#ch7-" + channel+"table").html(field[j]);
							}
						}
					});
					console.log( "success" );
				})
				.done(function(){
					console.log( "done" );
				})
				.fail(function(){
					console.log( "error" );
				})
				.always(function(){
					console.log( "complete" );
				});
				
				$.getJSON( "/saved_values/default19.json", function(result){
					$.each(result, function(i, field){
						if(i == "pert"){
							$('#pert19table').html(field);
						}
						else if(i == "leap"){
							$('#leap19table').html(field);
						}
						else if(i == "round_trip"){
							$('#trip19Valtable').html(field);
						}
						else if(i == "offset19"){
							for(j = 0; j < 19; j++){
								var channel = j + 1;
								$("#ch19-" + channel+"table").html(field[j]);
							}
						}
					});
					console.log( "success" );
				})
				.done(function(){
					console.log( "done" );
				})
				.fail(function(){
					console.log( "error" );
				})
				.always(function(){
					console.log( "complete" );
				});
			}
			load_table();
			/*********************************** Load data of uploaded file ***********************************************/
			document.getElementById('import').onclick = function() {
				var files = document.getElementById('selectFiles').files;
				console.log(files);
				if (files.length <= 0) {
					return false;
				}
			  
				var fr = new FileReader();
			  
				fr.onload = function(e) { 
					console.log(e);
					var result = JSON.parse(e.target.result);
					var formatted = JSON.stringify(result, null, 2);
					document.getElementById('result').value = formatted;
					$.each(result, function(i, field){
						if(i == "pert"){
							document.getElementById("pert7").value = field;			
							document.getElementById("pertVal7").value = field;
						}
						else if(i == "leap"){
							document.getElementById("leap7").value = field;						
							document.getElementById("leapVal7").value = field;
						}
						else if(i == "round_trip"){
							document.getElementById("round_trip7").value = field;							
							document.getElementById("tripVal7").value = field;
						}
						else if(i == "offset7"){
							for(j = 0; j < 7; j++){
								var channel = j + 1;
								document.getElementById("offset7_" + channel).value = field[j];
							}
						}
					});
				}
				fr.readAsText(files.item(0));
			};
		
			/*********************************** Load 7 channel default values ***********************************************/
			$("#load7").click(function(){
				$.getJSON( "/saved_values/default7.json", function(result){
					$.each(result, function(i, field){
						if(i == "pert"){
							document.getElementById("pert7").value = field;			
							document.getElementById("pertVal7").value = field;
						}
						else if(i == "leap"){
							document.getElementById("leap7").value = field;						
							document.getElementById("leapVal7").value = field;
						}
						else if(i == "round_trip"){
							document.getElementById("round_trip7").value = field;							
							document.getElementById("tripVal7").value = field;
						}
						else if(i == "offset7"){
							for(j = 0; j < 7; j++){
								var channel = j + 1;
								document.getElementById("offset7_" + channel).value = field[j];
							}
						}
					});
					console.log( "success" );
				})
				.done(function(){
					console.log( "done" );
				})
				.fail(function(){
					console.log( "error" );
				})
				.always(function(){
					console.log( "complete" );
				});
			});
			
		/*********************************** Load 19 channel default values ***********************************************/			
			$("#load19").click(function(){
				$.getJSON( "/saved_values/default19.json", function(result){
					$.each(result, function(i, field){
						if(i == "pert"){
							console.log("hi");
							document.getElementById("pert19").value = field;			
							document.getElementById("pert19Val").value = field;
						}
						else if(i == "leap"){
							document.getElementById("leap19").value = field;						
							document.getElementById("leap19Val").value = field;
						}
						else if(i == "round_trip"){
							document.getElementById("round_trip19").value = field;							
							document.getElementById("trip19Val").value = field;
						}
						else if(i == "offset19"){
							for(j = 0; j < 19; j++){
								var channel = j + 1;
								document.getElementById("offset19_" + channel).value = field[j];
							}
						}
					});
					console.log( "success" );
				})
				.done(function(){
					console.log( "done" );
				})
				.fail(function(){
					console.log( "error" );
				})
				.always(function(){
					console.log( "complete" );
				});
				
			});
		});
		</script>
	</head>
    <body>
		<nav class="navbar navbar-default navbar-custom" >
			<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#"><font color="white">Fiber Laser Phased-Array Controller</font></a>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a data-toggle="tab" href="#Home">Home</a></li>
					<li><a data-toggle="tab" href="#7">7 Channel Settings</a></li>
					<li><a data-toggle="tab" href="#19">19 Channel Settings</a></li>
					<img src="assets/original_cvorg-final_720.png" alt="CVORG Logo" style="width:270px;height:162px;" align="right-side">

				</ul>
			</div>
			</div>
		</nav>
		<div class="container" >
			<div class="tab-content">
				<div id="Home" class="tab-pane fade in active">
				<div class="panel-group">
				<div class="panel panel-default">
				<div class="panel-body">
					<p>Welcome to the Fiber Laser Phased-Array Controller</p>
				</div>
				</div>
				<div class="panel panel-default">
				<div class="panel-body">
					<form action="/" method="post">
					<button type="submit" class="btn btn-custom btn-md" formaction="/download7" title="Download the fiber laser array input values template." >Download 7-channel template</button>
					<button type="submit" class="btn btn-custom btn-md" formaction="/download19" title="Download the fiber laser array input values template." >Download 19-channel template</button>
					</form>
				</div>
				</div>
				</div>
				</div>
				<div id="7" class="tab-pane fade in">
				<div class="panel-group">
				<div class="panel panel-default">
				<div class="panel-body">
				<form action="/" method="post">
				<fieldset>
					<div class="row">
						<div class="col-sm-6"><b>Pert gain</b> (default value: 0.03; range: 0.001-1):</div>
						<div class="col-sm-2"><input type="range" id="pert7" name="pert" min="0.001" value="0.03" max="1" step="0.001" oninput="pertVal.value = pert.value"/></div>
						<div class="col-sm-2"><input name="pertVal" type="number" min="0.001" value="0.03" max="1" id="pertVal7" readonly /></div>
					</div>
					<br />
					
					<div class="row">
						<div class="col-sm-6"><b>Leap gain</b> (default value: 1500; range: 1-10000):</div>
						<div class="col-sm-2"><input type="range" id="leap7" name="leap" min="1" value="1500" max="10000" step="1" oninput="leapVal.value = leap.value" /> </div>
						<div class="col-sm-2"><input name="leapVal" type="number" min="1" value="1500" max="10000" id="leapVal7" readonly /> </div>
					</div>
					<br />

					<div class="row">
						<div class="col-sm-6"><b>Round trip time</b> (Default value: 10ns): </div>
						<div class="col-sm-2"><input type="range" id="round_trip7" name="round_trip" min="1e-8" value="1e-8" max="1e-7" step="1e-8" oninput="tripVal.value = round_trip.value"/></div>
						<div class="col-sm-2"><input name="tripVal" type="number" min="1e-8" value="1e-8" max="1e-7" id="tripVal7" readonly /></div>
					</div>
					<br />
					<br />
						
					<b>Channel offsets</b> (default for all: 0): 
					<br />
					<table class="table table-striped">
						<tr>
						<th>
						<label for="ch1"> 1:</label>
						<input type="number" name="offset7" id="offset7_1" value="0" placeholder="Enter offset" />
						</th>
				
						<th>
						<label for="ch2"> 2:</label>
						<input type="number" name="offset7" id="offset7_2" value="0" placeholder="Enter offset" />
						</th>
				
						<th>
						<label for="ch3"> 3:</label>
						<input type="number" name="offset7" id="offset7_3" value="0" placeholder="Enter offset" />
						</th>
				
						<tr>
						<th>
						<label for="ch4"> 4:</label>
						<input type="number" name="offset7" id="offset7_4" value="0" placeholder="Enter offset" />
						</th>
				
						<th>
						<label for="ch5"> 5:</label>
						<input type="number" name="offset7" id="offset7_5" value="0" placeholder="Enter offset" />
						</th>
				
						<th>
						<label for="ch6"> 6:</label>
						<input type="number" name="offset7" id="offset7_6" value="0" placeholder="Enter offset" />
						</th>
						</tr>
				
						<tr>
						<th>
						<th>
						<label for="ch7"> 7:</label>
						<input type="number" name="offset7" id="offset7_7" value="0" placeholder="Enter offset" />
						</th>
						</th>
						<th>
						</th>
						</tr>
				
					</table>
					</fieldset>
						<button type="submit" class="btn btn-custom btn-md col-sm-2" formaction="/run7" title="Runs the Fiber Laser Phased-Array Controller with 7 channels using the values above." >Run</button>
						<button type="submit" class="btn btn-custom btn-md col-sm-2" formaction="/update7" title="Updates the Fiber Laser Phased-Array Controller values to those above (if it is already running).">Update</button>
						<button type="submit" class="btn btn-custom btn-md col-sm-2" formaction="/reset7" title="Resets the Fiber Laser Phased-Array Controller (if it is already running).">Reset</button>
						<button type="submit" onclick="return confirm('Are you sure you wish to overwrite the saved 7-channel presets?')" class="btn btn-custom btn-md save col-sm-3" id="save7" formaction="/save7" title="Saves the currently entered values to the system's 7-channel preset file. DOES NOT download file.">Save 7 Channel Value Set</button>
						<button type="button" onclick="" class="btn btn-custom btn-md load col-sm-3" id="load7" formaction="/load7" title="Loads the values of the system's 7-channel preset file.">Load 7 Channel Presets</button>					
					</form>
					</div>
					</div>
					<div class="panel panel-default">
					<div class="panel-body">
						
						<div class="row">
							<div class="col-sm-6"> <b>Upload a JSON file with saved values (see instructions on Home tab):</b> </div>
							<div class="col-sm-6"> <b>Current saved presets:</b> </div>							
						</div>
						<div class="row">
							<div class="col-sm-6"><input type="file" id="selectFiles" value="Import" /></div>
							
						</div>
						<div class="row">
							<div class="col-sm-6"><textarea id="result" rows="8" cols="24"></textarea></div>
							<div class="col-sm-6"><table class="table table-striped">
								<tr>
								<th class='notbold'>Pert gain:</th>		<th id="pert7table" class="notbold"></th><th class='notbold'>Round trip time:</th>		<th id="trip7table" class="notbold"></th></tr>
								<tr>
								<th class='notbold'>Leap gain:</th>		<th id="leap7table" class="notbold"></th><th class='notbold'>Channel 1 Offset:</th>		<th id="ch7-1table" class="notbold"></th></tr>
								<tr><th class='notbold'>Channel 2 Offset:</th>		<th id="ch7-2table" class="notbold"></th><th class='notbold'>Channel 3 Offset:</th>		<th id="ch7-3table" class="notbold"></th></tr>
								<tr><th class='notbold'>Channel 4 Offset:</th>		<th id="ch7-4table" class="notbold"></th><th class='notbold'>Channel 5 Offset:</th>		<th id="ch7-5table" class="notbold"></th></tr>
								<tr><th class='notbold'>Channel 6 Offset:</th>		<th id="ch7-6table" class="notbold"></th><th class='notbold'>Channel 7 Offset:</th>		<th id="ch7-7table" class="notbold"></th></tr>						
							</table></div>
						</div>
						<div class="row">
							<div class="col-sm-6"> <button id="import" class="btn btn-custom btn-md col-sm-">Import</button></div>
						</div>
					</div>
					</div>
				</div>
				</div>
				
				<div id="19" class="tab-pane fade in">
				<form action="/" method="post">
					<div class="panel-group">
					<div class="panel panel-default">
					<div class="panel-body">
					<fieldset>
						<table>
							<tr>
							<th>
							<label for="pert7">Pert gain:</label>
							<input type="range" id="pert19" ="pert" min="0.001" value="0.03" max="1" step="0.001" oninput="pert19Val.value = pert19.value"/>
							(default value: 0.03; range: 0.001 - 1) 
							<input name="pertVal" type="number" min="0.001" value="0.03" max="1" id="pert19Val" readonly />
							</th>
							</tr>
						
							<tr>
							<th>
							<label for="leap19">Leap gain:</label>
							<input type="range" id="leap19" name="leap" min="1" value="1500" max="10000" step="1" oninput="leap19Val.value = leap19.value" />
							(default value: 1500; range: 1 - 10000)
							<input name="leapVal" type="number" min="1" value="1500" max="10000" id="leap19Val" readonly />
							</th>
							</tr>

							<tr>
							<th>
							<label for="round_trip19">Round trip time:</label>
							<input type="range" id="round_trip19" name="round_trip" min="1e-8" value="1e-8" max="1e-7" step="1e-8" oninput="trip19Val.value = round_trip19.value"/>
							(default value: 10ns)
							<input name="tripVal" type="number" min="1e-8" value="1e-8" max="1e-7" id="trip19Val" readonly />
							</th>
							</tr>
						</table>
						<br />
								
						Channel offsets (default for all: 0): 
						<br />
						<table class="table table-striped">
							<tr>
							
							<th><label for="ch1"> 1:</label>
							<input type="number" name="offset19" id="offset19_1" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label for="ch2"> 2:</label>
							<input type="number" name="offset19" id="offset19_2" value="0" placeholder="Enter offset" />
							</th>
						
							<th>
							<label for="ch3"> 3:</label>
							<input type="number" name="offset19" id="offset19_3" value="0" placeholder="Enter offset" />
							</th>
							
							<tr>
							<th>
							<label for="ch4"> 4:</label>
							<input type="number" name="offset19" id="offset19_4" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label for="ch5"> 5:</label>
							<input type="number" name="offset19" id="offset19_5" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label for="ch6"> 6:</label>
							<input type="number" name="offset19" id="offset19_6" value="0" placeholder="Enter offset" />
							</th>
							</tr>
							
							<tr>
							<th>
							<label for="ch7"> 7:</label>
							<input type="number" name="offset19" id="offset19_7" value="0" placeholder="Enter offset" />
							</th>
						
							<th>
							<label name="offset19" for="ch8"> 8:</label>
							<input type="number" name="offset19" id="offset19_8" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label name="offset19" for="ch9"> 9:</label>
							<input type="number" name="offset19" id="offset19_9" value="0" placeholder="Enter offset" />
							</th>
							</tr>
							
							<tr>
							<th>
							<label name="offset19" for="ch10">10:</label>
							<input type="number" name="offset19" id="offset19_10" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label name="offset19" for="ch11">11:</label>
							<input type="number" name="offset19" id="offset19_11" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label name="offset19" for="ch12">12:</label>
							<input type="number" name="offset19" id="offset19_12" value="0" placeholder="Enter offset" />
							</th>
							</tr>
							
							<tr>
							<th>
							<label name="offset19" for="ch13">13:</label>
							<input type="number" name="offset19" id="offset19_13" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label name="offset19" for="ch14">14:</label>
							<input type="number" name="offset19" id="offset19_14" value="0" placeholder="Enter offset" />
							</th>
						
							<th>
							<label name="offset19" for="ch15">15:</label>
							<input type="number" name="offset19" id="offset19_15" value="0" placeholder="Enter offset" />
							</th>
							</tr>
							
							<tr>
							<th>
							<label name="offset19" for="ch16">16:</label>
							<input type="number" name="offset19" id="offset19_16" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label name="offset19" for="ch17">17:</label>
							<input type="number" name="offset19" id="offset19_17" value="0" placeholder="Enter offset" />
							</th>
							
							<th>
							<label name="offset19" for="ch18">18:</label>
							<input type="number" name="offset19" id="offset19_18" value="0" placeholder="Enter offset" />
							</th>
							</tr>
							
							<tr>
							<th>
							<th>
							<label name="offset19" for="ch19">19:</label>
							<input type="number" name="offset19" id="offset19_19" value="0" placeholder="Enter offset" />
							</th>
							</th>
							<th>
							</th>
							</tr>
						</table>
						</fieldset>
							<button type="submit" class="btn btn-custom btn-md col-sm-2" formaction="/run19" title="Runs the Fiber Laser Phased-Array Controller with 19 channels using the values above">Run</button>
							<button type="submit" class="btn btn-custom btn-md col-sm-2" formaction="/update19" title="Updates the Fiber Laser Phased-Array Controller values to those above (if it is already running).">Update</button>
							<button type="submit" class="btn btn-custom btn-md col-sm-2" formaction="/reset19" title="Resets the Fiber Laser Phased-Array Controller (if it is already running).">Reset</button>
							<button type="submit" class="btn btn-custom btn-md save col-sm-3" onclick="return confirm('Are you sure you wish to overwrite the saved 19-channel presets?')"  id="save19" formaction="/save19" title="Saves the currently entered values to the system's 19-channel preset file. DOES NOT download file.">Save 19 Channel Value Set</button>
							<button type="button" class="btn btn-custom btn-md load col-sm-3" id="load19" formaction="/load19" title="Loads the values of the system's 19-channel preset file.">Load 19 Channel Presets</button>
						</form>
						</div>
						</div>
						<div class="panel panel-default">
						<div class="panel-body">
							<div class="row">
								<div class="col-sm-6"> <b>Upload a JSON file with saved values (see instructions on Home tab):</b> </div>
								<div class="col-sm-6"> <b>Current saved presets:</b> </div>							
							</div>
							<div class="row">
								<div class="col-sm-6"><input type="file" id="selectFiles" value="Import" /></div>
								
							</div>
							<div class="row">
								<div class="col-sm-6"><textarea id="result" rows="8" cols="24"></textarea></div>
								<div class="col-sm-6"><table class="table table-striped">
									<tr>
									<th class='notbold'>Pert gain:</th>		<th id="pert19table" class="notbold"></th><th class='notbold'>Round trip time:</th>		<th id="trip19table" class="notbold"></th></tr>
									<tr>
									<th class='notbold'>Leap gain:</th>		<th id="leap19table" class="notbold"></th><th class='notbold'>Channel 1 Offset:</th>		<th id="ch19-1table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 2 Offset:</th>		<th id="ch19-2table" class="notbold"></th><th class='notbold'>Channel 3 Offset:</th>		<th id="ch19-3table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 4 Offset:</th>		<th id="ch19-4table" class="notbold"></th><th class='notbold'>Channel 5 Offset:</th>		<th id="ch19-5table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 6 Offset:</th>		<th id="ch19-6table" class="notbold"></th><th class='notbold'>Channel 7 Offset:</th>		<th id="ch19-7table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 8 Offset:</th>		<th id="ch19-8table" class="notbold"></th><th class='notbold'>Channel 9 Offset:</th>		<th id="ch19-9table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 10 Offset:</th>		<th id="ch19-10table" class="notbold"></th><th class='notbold'>Channel 11 Offset:</th>		<th id="ch19-11table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 12 Offset:</th>		<th id="ch19-12table" class="notbold"></th><th class='notbold'>Channel 13 Offset:</th>		<th id="ch19-13table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 14 Offset:</th>		<th id="ch19-14table" class="notbold"></th><th class='notbold'>Channel 15 Offset:</th>		<th id="ch19-15table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 16 Offset:</th>		<th id="ch19-16table" class="notbold"></th><th class='notbold'>Channel 17 Offset:</th>		<th id="ch19-17table" class="notbold"></th></tr>
									<tr><th class='notbold'>Channel 18 Offset:</th>		<th id="ch19-18table" class="notbold"></th><th class='notbold'>Channel 19 Offset:</th>		<th id="ch19-19table" class="notbold"></th></tr>
								</table></div>
							</div>
							<div class="row">
								<div class="col-sm-6"> <button id="import" class="btn btn-custom btn-md col-sm-">Import</button></div>
							</div>

						</div>
						</div>
						<div class="panel panel-default">
						<div class="panel-body">
							
						</div>
						</div>
					
					</div>
				</div>
			</div>
		</div>
	</body>
</html>